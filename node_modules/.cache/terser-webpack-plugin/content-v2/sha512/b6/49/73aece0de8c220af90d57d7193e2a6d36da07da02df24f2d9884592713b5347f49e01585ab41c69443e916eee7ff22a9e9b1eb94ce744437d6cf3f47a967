{"code":"!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\"\",t(t.s=1)}([,function(e,n,t){\"use strict\";function o(e){return\"TEXT\"===e.type}t.r(n);const r=[\"RECTANGLE\",\"ELLIPSE\",\"POLYGON\",\"STAR\",\"VECTOR\"];function i(e){return r.indexOf(e.type)>=0}const c=[\"COMPONENT\",\"INSTANCE\",\"FRAME\"];function l(e){return c.indexOf(e.type)>=0}function s(e){let n=[];return o(e)&&n.push(e),l(e)&&e.children.length>0&&n.push(...e.children.map(s).filter(Boolean)),[].concat.apply([],n)}function a(e){let n=[];return i(e)&&(y(e)||n.push(e)),l(e)&&e.children.length>0&&n.push(...e.children.map(a).filter(Boolean)),[].concat.apply([],n)}function f(e){return\"IMAGE\"===e.type}function u(e){return e.fills?e.fills.some(f):!!e.backgrounds&&e.backgrounds.some(f)}function g(e){return 0!==e.length&&e.some(e=>e.children?g(e.children):i(e)||o(e))}function d(e){if(i(e))return u(e);if(l(e)){const n=u(e),t=h(e.children);return n||t}}function h(e){return 0!==e.length&&e.some(d)}function p(e){return e.fills?e.fills.find(f):e.backgrounds?e.backgrounds.find(f):void 0}function m(e){return!!g(e)&&(!h(e)&&function(e){return e.some(e=>{if(d(e))return!0;if(\"PAGE\"===e.type)return!1;const n=h(e.parent.children),t=y(e.parent);return n||t})}(e))}function y(e){return i(e)?!!u(e):l(e)?!!u(e):void 0}function O(e){for(let n of e){if(y(n))return n;if(n.children)return O(n.children)}}async function P(e){const n=p(e),t=figma.getImageByHash(n.imageHash),o=await t.getBytesAsync(),{width:r,height:i,name:c}=e;return{imageBytes:o,width:r,height:i,name:c}}function w(e,n,t={}){const o=e.fills.slice().map(e=>Object.assign({},e,{color:n},t));return e.fills=o}async function b(e,n){const{dominantColor:t,suggestedTextColors:r}=n;for(let c of e){if(o(c)){const e=c.name.includes(\"dominant\")?t:r[0];w(c,e,{opacity:.9})}if(i(c)&&(u(c)||w(c,t)),l(c))return b(c.children,n)}}function v(e){figma.ui.postMessage(e)}console.log(figma.currentPage.selection),figma.showUI(__html__,{visible:!1}),async function e(n){if(!function(e){return e.length>0}(n))return figma.closePlugin(\"Invalid selection\");if(n.length>1&&n.every(l)){console.log({1:n});for(let t of n)await e([t]);return Promise.resolve()}if(n.length>1&&n.every(y)){console.log({2:n});for(let t of n)await e([t]);return Promise.resolve()}if(function(e){if(1!==e.length)return!1;const n=e[0],t=i(n),o=l(n);return!(!t&&!o)&&!(o&&n.children.length>0)&&u(n)}(n)){console.log({3:n});const e=n[0];return v(await P(e)),new Promise(n=>(figma.ui.onmessage=async t=>{await async function(e,n){const{dominantColor:t,palette:o,suggestedTextColors:r}=n,i={r:0,g:0,b:0},c=e.height>300?300:e.height+32>300?300:e.height+32,l=c+24,s=c+264+24,a={family:\"SF Pro Text\",style:\"Bold\"};await figma.loadFontAsync(a);const f=figma.createFrame();f.resize(300,s),f.x=e.x+e.width+100,f.y=e.y,f.effects=[{type:\"DROP_SHADOW\",visible:!0,blendMode:\"NORMAL\",radius:12,offset:{x:0,y:2},color:Object.assign({},i,{a:.16})}],f.name=\"Dominant Color Utilities\";const u=figma.createRectangle();u.y=0,u.resize(300,c),u.fills=[{type:\"SOLID\",color:t,opacity:.08}],u.effects=[{type:\"INNER_SHADOW\",visible:!0,blendMode:\"NORMAL\",radius:0,offset:{x:0,y:-1},color:Object.assign({},i,{a:.08})}];const g=figma.createRectangle();g.name=\"Source image\",f.appendChild(u),f.appendChild(g);const d=p(e);g.fills=[d],g.cornerRadius=e.cornerRadius,g.resize(e.width>300?300:e.width,e.height<300?e.height:300),g.y=e.height>300?0:e.height+32>300?0:16,g.x=e.width>300?0:(300-e.width)/2;const h=figma.createText();h.name=\"Label\",h.fontName=a,h.fills=[{type:\"SOLID\",color:i}],h.fontSize=10;const m=h.clone();m.characters=\"DOMINANT COLOR\",m.y=l,m.x=16;const y=m.clone();y.characters=\"RECOMMENDED TEXT COLORS\",y.y=m.y+20+44+24;const O=y.clone();O.characters=\"PALETTE\",O.y=y.y+20+44+24,f.appendChild(m),f.appendChild(y),f.appendChild(O);const P=figma.createRectangle();P.name=\"Swatch\",P.cornerRadius=22,P.resize(44,44),P.x=16,P.y=m.y+20,P.strokeAlign=\"INSIDE\",P.strokes=[{type:\"SOLID\",color:i,opacity:.08}];const w=P.clone();w.fills=[{type:\"SOLID\",color:t}];const b=w.clone();b.y=y.y+20,b.fills=[{type:\"SOLID\",color:r[0]}];const v=b.clone();v.x=72,v.fills=[{type:\"SOLID\",color:r[1]}],f.appendChild(w),f.appendChild(b),f.appendChild(v);for(let[e,n]of o.entries()){let t=b.clone();t.x=16+56*e,t.y=O.y+20,t.fills=[{type:\"SOLID\",color:n}],f.appendChild(t)}return Promise.resolve(f)}(e,t).then(e=>{figma.currentPage.selection=[e],figma.viewport.scrollAndZoomIntoView([e]),n()})},Promise.resolve()))}if(function(e){if(1!==e.length)return!1;const n=e[0];return!!l(n)&&(u(n)?g(n.children):h(n.children))}(n)){console.log({4:n});const e=O(n);v(await P(e));const t=n[0],o=[...s(t),...a(t)];return new Promise(e=>(figma.ui.onmessage=async n=>{await b(o,n).then(()=>e())},Promise.resolve()))}if(function(e){if(1===e.length)return!1;const n=h(e),t=g(e);return n&&t}(n)){console.log({5:n});const e=O(n);v(await P(e));const t=[...function(e){return e.filter(o)}(n),...function(e){return e.filter(i)}(n)];return new Promise(e=>{figma.ui.onmessage=async n=>{await b(t,n).then(()=>e())}})}if(m(n)){console.log({6:n});const e=function e(n){for(let t of n)return y(t)?t:y(t.parent)?t.parent:e(t.parent.children)}(n);return v(await P(e)),new Promise(e=>(figma.ui.onmessage=async t=>{await b(n,t).then(()=>e())},Promise.resolve()))}figma.closePlugin(\"Couldn't process your selection. Please try again\")}(figma.currentPage.selection).then(()=>figma.closePlugin(\"Colors generated âœ¨\"))}]);","extractedComments":[]}